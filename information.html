<!DOCTYPE html>
<!-- saved from url=(0060)http://stmcrp.gzvtc.cn/student/wx/learner/leave/addLeavePage -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
		<title>请假申请</title>
		<link href="./2/mui.css" rel="stylesheet">
		<link rel="stylesheet" href="./2/mui.picker.min.css">
		<link rel="stylesheet" href="./2/common.css">
		<link rel="stylesheet" type="text/css" href="./2/font_764846_xq5fpej2zml.css">
		<style>
			.mui-bar{background: #00aaf6;}
			.mui-bar p{
				line-height: 44px;
				margin: 0;
				
			}
			.left,.right{width: 50%;}
			.mui-table-view-cell > a:not(.mui-btn){
				white-space: inherit;
			}
			.semester,.type,.auditStatus{overflow: hidden;padding: 11px 0;border-top:1px solid #e7e7e7;margin: 0 15px;}
			.mui-collapse-content .mui-row{margin-bottom: 10px;}
			.check,.noCheck {
			    background: #00aaf6;
			    border-radius: 5px;
			    color: #ffffff;
			    border: none;
			    height: 40px;
			    width: 40%;
			    line-height: inherit;
			    display: block;
			    margin: 0 auto;
			}
			.icon-save{
				float:right;
				width:24px;
				height: 24px;
				display: block;
				font-size: 24px;
			}
			.icon-right{
				float:right;
			}
			.mui-input-group:before,.mui-input-group:after,.mui-input-group .mui-input-row:after{
				right: 15px;
	    		left: 15px;
			}
			.mui-icon-clear:before {
				font-family: "iconfont" !important;
				content: "\e62a";
				color: #999999;
				line-height: 22px;
				font-size: 16px;
			}
			.mcrp-row{
				border-bottom:1px solid #e5e5e5;
				margin:0 15px;
			}
			.mui-input-group:after{
				height:0px;
			}
			textarea{
				padding:10px 0;
			}
		</style>
	</head>

	<body style="">
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon  mui-pull-left"></a>
			<!-- mui-icon-left-nav -->
			<p class="text-align-center font-size-mid">请假申请<span class="iconfont icon-save"></span></p>
			
		</header>
		<div class="mui-content">
			<div class="content ">
				<div class="type"><div class="mcrp-font-color font-size-mid">请假类型<i class="iconfont icon-right mcrp-font-memo-color"></i></div></div>
			</div>
			<form class="mui-input-group" id="myForm" enctype="multipart/form-data">
				<input type="hidden" id="type" name="studentleavetypeid">
			    <div class="mui-input-row">
			    	<input type="text" class="font-size-mid mcrp-font-color" placeholder="学号" autocomplete="off" readonly="readonly" value="191118102723">
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="font-size-mid mcrp-font-color" placeholder="姓名" autocomplete="off" readonly="readonly" value="谢凯旭">
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="font-size-mid mcrp-font-color" placeholder="专业" autocomplete="off" readonly="readonly" value="计算机应用技术">
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="font-size-mid mcrp-font-color" placeholder="班级" autocomplete="off" readonly="readonly" value="普高2019计算机应用技术2班">
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="font-size-mid mcrp-font-color" placeholder="当前学期" autocomplete="off" readonly="readonly" value="2020-2021学年第一学期">
			    </div>
			    <div class="mui-input-row">
			    	<input type="number" class="mui-input-clear font-size-mid mcrp-font-color" placeholder="本人联系电话" autocomplete="off" id="contractphonenumber" name="contractphonenumber" data-input-clear="6"><span class="mui-icon mui-icon-clear mui-hidden"></span>
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="mui-input-clear font-size-mid mcrp-font-color" placeholder="监护人" autocomplete="off" id="guardianname" name="guardianname" data-input-clear="7"><span class="mui-icon mui-icon-clear mui-hidden"></span>
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="mui-input-clear font-size-mid mcrp-font-color" placeholder="监护人电话" autocomplete="off" id="guardianphonenumber" name="guardianphonenumber" data-input-clear="8"><span class="mui-icon mui-icon-clear mui-hidden"></span>
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="mui-input-clear font-size-mid mcrp-font-color dateTimePicker" placeholder="请选择开始时间" id="startDate" name="starttime" data-input-clear="9"><span class="mui-icon mui-icon-clear mui-hidden"></span>
			    </div>
			    <div class="mui-input-row">
			    	<input type="text" class="mui-input-clear font-size-mid mcrp-font-color dateTimePicker" placeholder="请选择结束时间" id="endDate" name="endtime" data-input-clear="10"><span class="mui-icon mui-icon-clear mui-hidden"></span>
			    </div>
			    <div class="mui-input-row">
			    	<input type="hidden" name="type" value="0">
			    	<input type="number" class="mui-input-clear font-size-mid mcrp-font-color" placeholder="请假天数" autocomplete="off" id="scope" name="scope" data-input-clear="12"><span class="mui-icon mui-icon-clear mui-hidden"></span>
			    </div>
			    
			    
			    <div class="mcrp-row">
			    	<textarea class="mui-input-clear font-size-mid mcrp-font-color" placeholder="请假事由" rows="3" id="reason" name="reason"></textarea>
			    </div>
			
				<link rel="stylesheet" type="text/css" href="./2/weui.css">
				<div class="weui-cell">
					<div class="weui-cell__bd">
						<div class="weui-uploader__bd">
							<ul class="weui-uploader__files" id="uploaderFiles">
							</ul>
							<div class="weui-uploader__input-box">
								<input id="uploaderInput" class="weui-uploader__input js_file" type="file" accept="image/*" multiple="" name="attachment">
							</div>
						</div>
					</div>
				</div>
				<div class="weui-gallery" id="gallery">
		            <span class="weui-gallery__img" id="galleryImg"></span>
		            <div class="weui-gallery__opr">
		                <a href="javascript:" class="weui-gallery__del">
		                    <i class="weui-icon-delete weui-icon_gallery-delete"></i>
		                </a>
		            </div>
		        </div>
	        </form>
            </div>
		
		<style>
			.weui-cell:before{
				border-top:0px;
			}
		</style>
		<script src="./2/mui.js"></script>
		<script type="text/javascript" src="./2/mui.picker.min.js"></script>
		<script type="text/javascript" src="./2/jquery-2.0.3.min.js"></script>
		<script type="text/javascript" src="./2/common.js"></script>
		<script type="text/javascript" src="./2/vue.min.js"></script>
	    <script src="./2/mui.picker.js"></script>
		<script type="text/javascript">
		(function($) {
			$.init();
			var result = $('#result')[0];
			var btns = $('.dateTimePicker');
			btns.each(function(i, btn) {
				btn.addEventListener('tap', function() {
					var optionsJson = this.getAttribute('data-options') || '{}';
					var options = JSON.parse(optionsJson);
					var id = this.getAttribute('id');
					/*
					 * 首次显示时实例化组件
					 * 示例为了简洁，将 options 放在了按钮的 dom 上
					 * 也可以直接通过代码声明 optinos 用于实例化 DtPicker
					 */
					var picker = new $.DtPicker(options);
					picker.show(function(rs) {
						/*
						 * rs.value 拼合后的 value
						 * rs.text 拼合后的 text
						 * rs.y 年，可以通过 rs.y.vaue 和 rs.y.text 获取值和文本
						 * rs.m 月，用法同年
						 * rs.d 日，用法同年
						 * rs.h 时，用法同年
						 * rs.i 分（minutes 的第二个字母），用法同年
						 */
						document.querySelector('#'+id).value=rs.text;
						/* 
						 * 返回 false 可以阻止选择框的关闭
						 * return false;
						 */
						/*
						 * 释放组件资源，释放后将将不能再操作组件
						 * 通常情况下，不需要示放组件，new DtPicker(options) 后，可以一直使用。
						 * 当前示例，因为内容较多，如不进行资原释放，在某些设备上会较慢。
						 * 所以每次用完便立即调用 dispose 进行释放，下次用时再创建新实例。
						 */
						picker.dispose();
					});
				}, false);
			});
		})(mui);
			var basePath ='./请假申请.html';
			
			var type = '';
			var typeArray = [{"id":1,"name":"事假","schoolid":1,"creatorid":1,"createtime":1600065457000,"modifierid":null,"modifytime":null,"status":0,"memo":null},{"id":2,"name":"病假","schoolid":1,"creatorid":57237,"createtime":1600917169000,"modifierid":null,"modifytime":null,"status":0,"memo":null}];
			var typePicker = new mui.PopPicker();
			var typeData = [];
			typeData.push({value:0,text:"全部"});
			$.each(typeArray, function(i,item) {
				typeData.push({value:item.id,text:item.name});
			});
			typePicker.setData(typeData);
			$(".type").on('tap',function(){
				typePicker.show(function (selectItems) {
					$(".type .right").html(selectItems[0].text);
					var text = selectItems[0].text;
					var value = selectItems[0].value;
					type = value;
					$(".type div").html(text+'<i class="iconfont icon-right mcrp-font-memo-color"></i>');
					$("#type").val(value);
	    		})
			})
			
		</script><div class="mui-poppicker">		<div class="mui-poppicker-header">			<button class="mui-btn mui-poppicker-btn-cancel">取消</button>			<button class="mui-btn mui-btn-blue mui-poppicker-btn-ok">确定</button>			<div class="mui-poppicker-clear"></div>		</div>		<div class="mui-poppicker-body">		<div class="mui-picker" style="width: 100%;">		<div class="mui-picker-inner">			<div class="mui-pciker-rule mui-pciker-rule-ft"></div>			<ul class="mui-pciker-list" style="transform: perspective(1000px) rotateY(0deg) rotateX(0deg);"><li class="highlight" style="transform-origin: center center -89.5px; transform: translateZ(89.5px) rotateX(0deg);">全部</li><li class="visible" style="transform-origin: center center -89.5px; transform: translateZ(89.5px) rotateX(-20deg);">事假</li><li class="visible" style="transform-origin: center center -89.5px; transform: translateZ(89.5px) rotateX(-40deg);">病假</li></ul>			<div class="mui-pciker-rule mui-pciker-rule-bg"></div>		</div>	</div></div>	</div>
		<script type="text/javascript" src="./2/jweixin-1.0.0.js"></script>
	    <script src="./2/weui.min.js"></script>
	    <script type="text/javascript">
	    $(function(){
	    	  var tmpl = '<li class="weui-uploader__file" style="background-image:url(#url#)"></li>',
	          $gallery = $("#gallery"), $galleryImg = $("#galleryImg"),
	          $uploaderInput = $("#uploaderInput"),
	          $uploaderFiles = $("#uploaderFiles")
	          ;
	
	      $uploaderInput.on("change", function(e){
	    	  var _this = this;
	          var src, url = window.URL || window.webkitURL || window.mozURL, files = e.target.files;
	          for (var i = 0, len = files.length; i < len; ++i) {
	              var file = files[i];
					console.log(file)
	              if (url) {
	                  src = url.createObjectURL(file);
	              } else {
	                  src = e.target.result;
	              }
	
					$(_this).clone(true).insertAfter(_this);
					$(_this).attr("id","");
					 $uploaderInput = $("#uploaderInput")
	              $uploaderFiles.append($(tmpl.replace('#url#', src)));
	          }
	      });
	      $uploaderFiles.on("click", "li", function(){
	          $galleryImg.attr("style", this.getAttribute("style"));
	          $gallery.fadeIn(100);
	          var _this = this;
	          $(".weui-icon-delete").on('tap',function(){
	        	  _this.remove();
	          })
	      });
	      $gallery.on("click", function(){
	          $gallery.fadeOut(100);
	      });
	      
	    });
	    
	    </script>
	    <script type="text/javascript" src="./2/jquery.form.js"></script>
	    <script type="text/javascript">
		$(".icon-save").on('tap',function(){
			var type = $("#type").val();
			if(type==''||type==0){
				mui.alert("请选择请假类型","请假申请结果","确定",function(){},'div');
				return false;
			}
			var contractphonenumber = $("#contractphonenumber").val();
			var guardianphonenumber = $("#guardianphonenumber").val();
			if(contractphonenumber.length!=11 || contractphonenumber==''){
				mui.alert("请填写正确的本人联系电话","请假申请结果","确定",function(){},'div');
				return false;
			}
			if(guardianphonenumber.length!=11 || guardianphonenumber==''){
				mui.alert("请填写正确的监护人联系电话","请假申请结果","确定",function(){},'div');
				return false;
			}
			var scopeVal = $("#scope").val().trim();
			if(scopeVal==''){
				mui.alert("请填写请假天数","请假申请结果","确定",function(){},'div');
				return false;
			}
			var guardiannameVal = $("#guardianname").val().trim();
			if(guardiannameVal==''){
				mui.alert("请填写监护人","请假申请结果","确定",function(){},'div');
				return false;
			}
			var reasonVal = $("#reason").val().trim();
			if(reasonVal==''){
				mui.alert("请填写请假原因","请假申请结果","确定",function(){},'div');
				return false;
			}
			// // $(".icon-save").hide();
	    	//   $("#myForm").ajaxSubmit({
	    	// 		// beforeSerialize : function(form, options) {
	    	// 		// 	$("#uploaderInput").remove();
	    	// 		// 	return true;
	    	// 		// },
	    	// 		type : "post",
			// 		// url : basePath+"wx/learner/leave/saveLeave", // 提交的URL
			// 		url : basePath, // 提交的URL
	    	// 		statusCode :{
	    	// 		   204 : function(){
	    	// 			   mui.alert("提交成功","请假申请结果","确定",function(){
	    	// 				   window.history.go(-1);
	    	// 			   },'div');
	    	// 		   },
	    	// 		   500 : function(){
	    	// 			   $(".icon-save").show();
	    	// 			   mui.alert("提交失败，请联系系统管理员","请假申请结果","确定",function(){
	    					  
	    	// 			   },'div');
	    	// 		   }
	    			  
	    	// 	   }
	    	// 	}); 
			return false;
	    })
	    
	    
	    </script>
	

</body></html>